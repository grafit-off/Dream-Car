document.addEventListener("DOMContentLoaded",()=>{const o=document.querySelectorAll(".animate-item"),r=(e,t,o)=>{let r=e.getBoundingClientRect();r.top+r.height-r.height*o>0&&window.innerHeight-r.top-r.height*t>0?e.classList.add("animated"):e.hasAttribute("data-animation-once")||e.classList.remove("animated")};0!=o.length&&(o.forEach(e=>{r(e,.5,.5)}),document.addEventListener("scroll",()=>{o.forEach(e=>{r(e,.5,.5)})}));const n=null!=navigator.userAgent.match(/iPhone/i),a=null!=navigator.userAgent.match(/iPad/i),l=null!=navigator.userAgent.match(/iPod/i);let i=()=>{let e=window.scrollY;document.querySelector("html").style.scrollBehavior="auto",document.body.classList.add("ios-lock"),document.body.dataset.position=e,document.body.style.top=-e+"px"},c=()=>{let e=parseInt(document.body.dataset.position,10);document.body.style.top="auto",document.body.classList.remove("ios-lock"),window.scroll({top:e,left:0}),document.querySelector("html").removeAttribute("style"),document.body.removeAttribute("data-position")};const s=document.querySelector("body"),d=document.querySelectorAll(".modal-btn"),u=document.querySelectorAll(".fixed-padding"),m=document.querySelectorAll(".close-modal");let h,p,y,g=!0,f=!1;if(d.length>0)for(let e=0;e<d.length;e++){const t=d[e];t.addEventListener("click",(function(e){const o=t.dataset.path,r=document.getElementById(o);null!=r?(v(r),setTimeout(()=>{m.forEach(e=>{e.focus()})},100),e.preventDefault()):console.log("Модальное окно не существует! "+r)}))}if(m.length>0)for(let e=0;e<m.length;e++){const t=m[e];h=t,t.addEventListener("click",(function(e){S(t.closest(".modal")),e.preventDefault()}))}function v(e){if(e&&g){y=document.activeElement;const t=document.querySelector(".modal.open");t?S(t,!1):function(){const e=window.innerWidth-s.offsetWidth+"px";if(u.length>0)for(let t=0;t<u.length;t++){u[t].style.paddingRight=e}s.style.paddingRight=e,s.classList.contains("lock")?p=!1:(p=!0,n||a||l?i():s.classList.add("lock"));g=!1,setTimeout((function(){g=!0}),800)}(),e.classList.add("open"),e.addEventListener("mousedown",(function(e){!1===f?(e.target.closest(".modal__content")||S(e.target.closest(".modal")),f=!0):setTimeout(()=>{f=!1},800)}))}}function S(e,t=!0){g&&(e.classList.remove("open"),t&&setTimeout((function(){if(u.length>0)for(let e=0;e<u.length;e++)u[e].style.paddingRight="0px";s.style.paddingRight="0px",1==p&&(n||a||l?c():s.classList.remove("lock"))}),800)),setTimeout((function(){y.focus()}),800)}document.addEventListener("keydown",(function(e){if(document.querySelector(".modal.open")&&27===e.which){S(document.querySelector(".modal.open"))}})),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);const q=document.querySelector(".theme-switcher"),b=e=>{localStorage.setItem("site-theme",e),document.documentElement.className=e};void 0===localStorage.getItem("site-theme")||null===localStorage.getItem("site-theme")?b("dark-theme"):(b(localStorage.getItem("site-theme")),"dark-theme"===localStorage.getItem("site-theme")?q.textContent="Светлая тема":q.textContent="Тёмная тема");q.addEventListener("click",()=>{"dark-theme"===localStorage.getItem("site-theme")?(b("light-theme"),q.textContent="Тёмная тема"):(b("dark-theme"),q.textContent="Светлая тема")});new Swiper(".swiper",{containerModifierClass:"swiper",wrapperClass:"swiper__wrapper",slideClass:"swiper__slide",loop:!0,pagination:{bulletElement:"button"},a11y:{prevSlideMessage:"Предыдущий слайд",nextSlideMessage:"Следующий слайд",paginationBulletMessage:"Перейти к слайду {{index}}"},breakpoints:{320:{slidesPerView:2.05,spaceBetween:10,pagination:!1},480:{slidesPerView:3,spaceBetween:15,navigation:!1,pagination:{el:".hero-buttons__pagination",clickable:!0}},992:{slidesPerView:3,spaceBetween:15,pagination:{el:".hero-buttons__pagination",clickable:!0},navigation:{nextEl:".hero-buttons__swiper--next",prevEl:".hero-buttons__swiper--prev"}}}});if(n||a||l){let e=document.querySelectorAll('[href^="#"]'),o=.2;for(let r=0;r<e.length;r++)e[r].addEventListener("click",(function(e){e.preventDefault();let r=window.pageYOffset,n=this.href.replace(/[^#]*(.*)/,"$1");t=document.querySelector(n).getBoundingClientRect().top,start=null,requestAnimationFrame((function e(a){null===start&&(start=a);let l=a-start,i=t<0?Math.max(r-l/o,r+t):Math.min(r+l/o,r+t);window.scrollTo(0,i),i!=r+t?requestAnimationFrame(e):location.hash=n}))}),!1)}const w=document.querySelectorAll(".accordion__trigger"),_=e=>{e.disabled=!0,setTimeout(()=>{e.disabled=!1},500)},L=(e,t)=>{t.style.height=t.scrollHeight+"px","0px"!==t.style.height&&"0px"!==window.getComputedStyle(t).height||(e.classList.add("accordion__trigger--active"),e.setAttribute("aria-expanded","true"),t.setAttribute("aria-hidden","false"),t.classList.remove("accordion__body--hidden"))},E=(e,t)=>{"0px"!==t.style.height&&"0px"!==window.getComputedStyle(t).height&&(e.classList.remove("accordion__trigger--active"),e.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true"),t.style.height=t.scrollHeight+"px",setTimeout(()=>{t.style.height="0"},0),setTimeout(()=>{t.classList.add("accordion__body--hidden")},500))},k=e=>{e.addEventListener("transitionend",()=>{"0px"!==e.style.height&&(e.style.height="auto")})};w.forEach(e=>{e.addEventListener("click",e=>{(e=>{const t=e,o=e.closest(".accordion__item").querySelector(".accordion__body");k(o),E(t,o),L(t,o),_(t)})(e.currentTarget)})});const x=[document.querySelector(".hero-buttons__order"),document.querySelector(".hero__btn")],A=document.querySelector(".accordion__constructor-form");x.forEach(e=>{e.addEventListener("click",()=>{let o=e.dataset.accpath,r=document.querySelector(".accordion").querySelector(`[data-accpath="${o}"]`),n=r.querySelector(".accordion__trigger"),a=r.querySelector(".accordion__body");_(n),_(e),L(n,a),k(a),setTimeout(()=>{(()=>{V=.7;let e=window.pageYOffset;t=A.getBoundingClientRect().top,start=null,requestAnimationFrame((function o(r){null===start&&(start=r);let n=r-start,a=t<0?Math.max(e-n/V,e+t):Math.min(e+n/V,e+t);window.scrollTo(0,a),a!=e+t&&requestAnimationFrame(o)}))})(),document.querySelector('[name="Форма ячейки"]').focus()},500)})});document.querySelectorAll(".accordion-close").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".accordion__item"),o=t.querySelector(".accordion__trigger"),r=t.querySelector(".accordion__body");_(e),_(o),E(o,r),o.focus()})});const T=document.querySelector(".image-preview__current"),j=document.querySelector(".image-preview__list");j.addEventListener("click",e=>{(e=>{let t=T.getAttribute("src"),o=T.getAttribute("alt"),r=e.getAttribute("src"),n=e.getAttribute("alt");T.setAttribute("src",""+r),T.setAttribute("alt",""+n),e.setAttribute("src",""+t),e.setAttribute("alt",""+o)})(e.target.querySelector(".preview-item__image"))});const C=document.querySelector(".schild__input"),N=document.querySelector(".schild__plus"),I=document.querySelector(".schild__minus"),M=document.querySelector(".order-info__list"),R=document.querySelector('input[value="Металлический подпятник"]'),B=document.querySelector('input[value="Передний ряд"]'),O=document.querySelector('input[value="Задний ряд"]'),P=document.querySelector('input[value="Багажник"]'),D=document.querySelector(".price-block__price");let $=0,H=0;const F=()=>{D.textContent=$+H},J=()=>{if(0===M.children.length){const e=document.createElement("li");e.className="order-info__item main-text order-clear",e.textContent=" Здесь пусто",M.append(e)}},Y=(e,t,o,r)=>{if(e.checked){$+=r;const e=document.createElement("li");e.className="order-info__item main-text "+t,e.textContent=" "+o,M.append(e),document.querySelector(".order-clear")&&document.querySelector(".order-clear").remove()}else null!==document.querySelector("."+t)&&($-=r,document.querySelector("."+t).remove(),J());F()},W=()=>{if(H=50*parseInt(C.value,10),0!==parseInt(C.value,10)){if(null===document.querySelector(".order-schild")){const e=document.createElement("li");e.className="order-info__item main-text order-schild",e.innerHTML=` Фирменные шильды ${C.value} шт.`,M.append(e)}else document.querySelector(".order-schild").textContent=` Фирменные шильды ${C.value} шт.`;document.querySelector(".order-clear")&&document.querySelector(".order-clear").remove()}else null!==document.querySelector(".order-schild")&&(document.querySelector(".order-schild").remove(),J());F()};C.addEventListener("blur",()=>{C.value<101&&C.value>=0||(C.value=0),W()}),C.addEventListener("keydown",()=>{isNaN(parseInt(C.value,10))&&(C.value=0)}),N.addEventListener("click",()=>{(()=>{let e=parseInt(C.value,10);e=isNaN(e)?0:++e,e>100&&(e=0),C.value=e})(),W()}),I.addEventListener("click",()=>{(()=>{let e=parseInt(C.value,10);e=isNaN(e)?0:--e,e<0&&(e=100),C.value=e})(),W()}),C.addEventListener("keydown",e=>{"Enter"==e.key&&W()}),Y(R,"order-heel","Подпятник",500),R.addEventListener("change",()=>{Y(R,"order-heel","Подпятник",500)}),Y(B,"order-front-row","Комплект ковриков для переднего ряда",1700),B.addEventListener("change",()=>{Y(B,"order-front-row","Комплект ковриков для переднего ряда",1700)}),Y(O,"order-back-row","Комплект ковриков для заднего ряда",1600),O.addEventListener("change",()=>{Y(O,"order-back-row","Комплект ковриков для заднего ряда",1600)}),P.addEventListener("change",()=>{Y(P,"order-trunk","Коврик для багажника",1e3)});const z=document.querySelectorAll('input[type="tel"]');new Inputmask("+7 (999) 999-99-99").mask(z);new Inputmask("999",{placeholder:""}).mask(C);let G=!1;const K=(e,t)=>{new window.JustValidate(e,{rules:t,messages:{name:{required:"Это поле обязательно!"},auto:{required:"Это поле обязательно!"},tel:{required:"Это поле обязательно!",strength:"Номер введен неправильно!"},email:{required:"Это поле обязательно!",email:"Пожалуйста! Введите действительный эмейл!"},message:{required:"Это поле обязательно!"},subject:{required:"Это поле обязательно!"}},submitHandler:(e,t,o)=>{G=!0}})};K(".form",{name:{required:!0},auto:{required:!0},tel:{required:!0,minLength:18,maxLenght:18,strength:{custom:/^\+7 \([0-9]+\) [0-9]+-[0-9]+-[0-9]+$/i}}}),K(".call-form",{name:{required:!0},tel:{required:!0,minLength:18,maxLenght:18,strength:{custom:/^\+7 \([0-9]+\) [0-9]+-[0-9]+-[0-9]+$/i}}}),K(".reviews-form",{name:{required:!0},subject:{required:!0},message:{required:!0},email:{required:!0,email:!0}});const Q=document.querySelector(".snackbar-btn"),U=document.querySelector(".snackbar");function X(e=U.textContent,t,o=3100,r=0){U.textContent=e,Q&&(Q.disabled=!0),setTimeout(()=>{U.removeAttribute("hidden"),0==t?(U.classList.add("show-notification"),setTimeout(()=>{U.className=U.className.replace("show-notification",""),U.setAttribute("hidden","")},o)):1==t&&(U.classList.add("show-attention"),setTimeout(()=>{U.className=U.className.replace("show-attention",""),U.setAttribute("hidden","")},o)),Q&&setTimeout(()=>{Q.disabled=!1},o)},r)}const Z=document.querySelector(".accordion__constructor-form"),ee=document.querySelector(".form"),te=document.querySelector(".form__submit"),oe={};Z.addEventListener("submit",()=>{e.preventDefault()}),ee.addEventListener("submit",async e=>{if(e.preventDefault(),te.disabled=!0,setTimeout(()=>{te.disabled=!1},1e3),G&&$>0&&!document.querySelector('input[name="Имя"]').classList.contains("js-validate-error-field")&&!document.querySelector('input[name="Модель автомобиля"]').classList.contains("js-validate-error-field")&&!ee.querySelector("input[type='tel']").classList.contains("js-validate-error-field")){const e=ee.querySelector('input[name="Имя"]').value,t=ee.querySelector('input[name="Модель автомобиля"]').value,o=ee.querySelector("input[type='tel']").value,r=R.checked,n=B.checked,a=O.checked,l=P.checked,i=C.value,c=document.querySelectorAll('input[name="Цвет окантовки"]'),s=document.querySelectorAll('input[name="Цвет полотна"]'),d=document.querySelectorAll('input[name="Форма ячейки"]');oe.order={},oe.order.name=e,oe.order.tel=o,oe.order.auto=t,oe.order.heel=r,oe.order.frontRow=n,oe.order.backRow=a,oe.order.trunk=l,oe.order.schild=i,oe.order.price=$,d.forEach(e=>{e.checked&&(oe.order.shape=e.value)}),s.forEach(e=>{e.checked&&(oe.order.canvas=e.value)}),c.forEach(e=>{e.checked&&(oe.order.edging=e.value)});let u=await fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify(oe),headers:{"Content-type":"application/json; charset=utf-8"}});if(console.log("Sending data..."),await u.ok){console.log("Response status: "+await u.status);let e=ee.closest(".modal"),t=await u.json();console.log("Request data..."),console.log(t),S(e),setTimeout(()=>{X("Ваш заказ успешно отправлен! Мы скоро с Вами свяжемся!",0)},800)}else setTimeout(()=>{X("Ошибка! Попробуйте еще раз!",1)},800)}if(0==$){S(ee.closest(".modal")),setTimeout(()=>{X("Ваш заказ пуст! Прежде чем отправить заказ, выберите товар!",1)},800)}});const re=document.querySelector(".call-form"),ne=document.querySelector(".call-form__submit");re.addEventListener("submit",async e=>{if(e.preventDefault(),ne.disabled=!0,setTimeout(()=>{ne.disabled=!1},1e3),G&&!re.querySelector('input[name="name"]').classList.contains("js-validate-error-field")&&!re.querySelector('input[name="tel"]').classList.contains("js-validate-error-field")){console.log("Sending data..."),oe.callback={};const e=re.querySelector('input[name="name"]').value,t=re.querySelector('input[name="tel"]').value;oe.callback.name=e,oe.callback.tel=t;let o=await fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify(oe),headers:{"Content-Type":"application/json; charset=utf-8"}});if(await o.ok){console.log("Request data..."),console.log("Status: "+await o.status);let e=await o.json();console.log(e),X("Спасибо! Мы скоро Вам перезвоним!","0")}else setTimeout(()=>{X("Ошибка! Попробуйте еще раз!",1)},800)}});const ae=document.querySelector(".reviews-form"),le=document.querySelector(".reviews-form__submit");ae.addEventListener("submit",async e=>{if(e.preventDefault(),le.disabled=!0,setTimeout(()=>{le.disabled=!1},1e3),G&&!ae.querySelector('input[name="name"]').classList.contains("js-validate-error-field")&&!ae.querySelector('input[name="email"]').classList.contains("js-validate-error-field")&&!ae.querySelector('input[name="subject"]').classList.contains("js-validate-error-field")&&!ae.querySelector('textarea[name="message"]').classList.contains("js-validate-error-field")){console.log("Sending data..."),oe.review={};const e=ae.querySelector('input[name="name"]').value,t=ae.querySelector('input[name="email"]').value,o=ae.querySelector('input[name="subject"]').value,r=ae.querySelector('textarea[name="message"]').value;oe.review.name=e,oe.review.email=t,oe.review.subject=o,oe.review.message=r;let n=await fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify(oe),headers:{"Content-Type":"application/json; charset=utf-8"}});if(await n.ok){console.log("Request data..."),console.log("Status: "+await n.status);let e=await n.json();console.log(e),X("Спасибо за отзыв!","0")}else setTimeout(()=>{X("Ошибка! Попробуйте еще раз!",1)},800)}})});